
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Math background &#8212; Quant Finance in Python</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/format.css" />
    <link rel="stylesheet" type="text/css" href="_static/.ipynb_checkpoints/format-checkpoint.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://host.kelley.iu.edu/nstoffma/01a math.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Asset returns" href="01b%20finance.html" />
    <link rel="prev" title="Introduction" href="intro.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/qf.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Quant Finance in Python</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Introduction
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Preliminaries
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Math background
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="01b%20finance.html">
   Asset returns
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Econometrics
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="probability.html">
   Probability
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="02a%20Probability%20theory.html">
     Probability theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02b%20Pseudorandom%20number%20generation.html">
     Pseudorandom number generation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02c%20Covariance.html">
     Covariance
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02d%20Estimation.html">
     Parameter estimation
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="regression.html">
   Regression
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="04a%20Regression%20theory.html">
     Linear regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="04b%20Regression%20applications.html">
     Implementing regressions
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Predictability
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="05a%20Predictability.html">
   Return predictability
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Portfolio optimization
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="optimization.html">
   Optimization
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Returns
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="returns.html">
   Returns
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Reference
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="notation.html">
   Notation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="sources.html">
   Additional sources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="bibliography.html">
   Bibliography
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/01a math.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/01a math.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#e-and-the-exponential-function">
   <span class="math notranslate nohighlight">
    \(e\)
   </span>
   and the exponential function
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#factorials">
   Factorials
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#combinations">
   Combinations
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#infinite-series">
   Infinite series
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#functions">
   Functions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-fundamental-theorems-of-calculus">
   The fundamental theorems of calculus
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#linearity-of-integrals">
     Linearity of integrals
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#gaussian-integral">
   Gaussian integral
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-gamma-function">
   The gamma function
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#taylor-series">
   Taylor series
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#vectors">
   Vectors
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#matrices">
   Matrices
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#matrix-multiplication">
     Matrix multiplication
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#identity-matrix">
     Identity matrix
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#transpose">
     Transpose
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#inverse">
     Inverse
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solving-systems-of-equations">
     Solving systems of equations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#quadratic-form">
     Quadratic form
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercises">
   Exercises
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Math background</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#e-and-the-exponential-function">
   <span class="math notranslate nohighlight">
    \(e\)
   </span>
   and the exponential function
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#factorials">
   Factorials
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#combinations">
   Combinations
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#infinite-series">
   Infinite series
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#functions">
   Functions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-fundamental-theorems-of-calculus">
   The fundamental theorems of calculus
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#linearity-of-integrals">
     Linearity of integrals
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#gaussian-integral">
   Gaussian integral
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-gamma-function">
   The gamma function
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#taylor-series">
   Taylor series
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#vectors">
   Vectors
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#matrices">
   Matrices
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#matrix-multiplication">
     Matrix multiplication
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#identity-matrix">
     Identity matrix
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#transpose">
     Transpose
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#inverse">
     Inverse
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solving-systems-of-equations">
     Solving systems of equations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#quadratic-form">
     Quadratic form
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercises">
   Exercises
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="math-background">
<h1>Math background<a class="headerlink" href="#math-background" title="Permalink to this headline">¶</a></h1>
<p>We begin with a brief review of some basic mathematical facts that will be useful in the remainder of the course.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># A helper function for plotting functions</span>
<span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">*</span><span class="n">xlim</span><span class="p">,</span> <span class="mi">250</span><span class="p">)</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">func</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="e-and-the-exponential-function">
<h2><span class="math notranslate nohighlight">\(e\)</span> and the exponential function<a class="headerlink" href="#e-and-the-exponential-function" title="Permalink to this headline">¶</a></h2>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>The number <span class="math notranslate nohighlight">\(e\)</span> has a fascinating history, recounted in the excellent book <a class="reference external" href="https://www.google.com/books/edition/E/BdKoQgAACAAJ?hl=en">e: The Story of a Number</a> by Eli Maor.</p>
</div>
<p>The irrational number <span class="math notranslate nohighlight">\(e\)</span>, also called Euler’s number, is defined as</p>
<div class="math notranslate nohighlight">
\[e := \lim _{n\to \infty }\left(1+{\frac {1}{n}}\right)^{n}.\]</div>
<p>The figure below plots the function <span class="math notranslate nohighlight">\(\left(1+{\frac {1}{n}}\right)^{n}\)</span>. As <span class="math notranslate nohighlight">\(n\)</span> increases, it approaches the value of <span class="math notranslate nohighlight">\(e\)</span>, which is approximately 2.7.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="p">(</span><span class="k">lambda</span> <span class="n">n</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="n">n</span><span class="p">)</span><span class="o">**</span><span class="n">n</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/01a math_7_0.png" src="_images/01a math_7_0.png" />
</div>
</div>
<p>More generally, the exponential function is defined as</p>
<div class="math notranslate nohighlight">
\[\exp(x) := e^x = \lim _{n\to \infty }\left(1+{\frac {x}{n}}\right)^{n}.\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">exp</span><span class="p">,</span> <span class="n">log</span><span class="p">,</span> <span class="n">pi</span> <span class="k">as</span> <span class="n">π</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.0, 2.718281828459045, 7.38905609893065]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="p">(</span><span class="n">exp</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/01a math_11_0.png" src="_images/01a math_11_0.png" />
</div>
</div>
<p>The exponential function plays a critical role in models of things that grow, be it bacteria in a culture or money in a bank account.</p>
<div class="tip admonition">
<p class="admonition-title">Fun fact.</p>
<p>If you want to impress your friends tell them <a class="reference external" href="https://twitter.com/phalpern/status/1238889392162439169">that</a></p>
<div class="math notranslate nohighlight">
\[e^{\pi i} + 1 = 0.\]</div>
<p>If you <em>really</em> want to impress them, <a class="reference external" href="https://en.wikipedia.org/wiki/Euler%27s_formula">prove it</a>!</p>
</div>
<p>The inverse of the exponential function is the natural logarithm:</p>
<div class="math notranslate nohighlight">
\[\ln(e^x) = x.\]</div>
<p>Economists just call the natural logarithm “log”; there is never a need to distinguish this from the logarithm in any other base.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>While <span class="math notranslate nohighlight">\(e^{\ln(10)}\)</span> is obviously exactly equal to 10, note that the answer is represented with a tiny amount of error. This is due to the <a class="reference external" href="https://en.wikipedia.org/wiki/Floating-point_arithmetic#Accuracy_problems">accuracy problems</a> inherent in the floating-point system for representing real numbers. For all practical purposes in financial applications, errors this small will be irrelevant.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">exp</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>10.000000000000002
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">log</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.302585092994046
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="p">(</span><span class="n">log</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.005</span><span class="p">,</span><span class="mi">25</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/01a math_18_0.png" src="_images/01a math_18_0.png" />
</div>
</div>
<p>Logarithms have the property that</p>
<div class="math notranslate nohighlight">
\[\ln(xy) = \ln(x) + \ln(y).\]</div>
</div>
<div class="section" id="factorials">
<h2>Factorials<a class="headerlink" href="#factorials" title="Permalink to this headline">¶</a></h2>
<p>The factorial of a positive integer <span class="math notranslate nohighlight">\(n\)</span> is the product of all integers from 1 up to <span class="math notranslate nohighlight">\(n\)</span>:</p>
<div class="math notranslate nohighlight">
\[{\displaystyle n!=n\cdot (n-1)\cdot (n-2)\cdot (n-3)\cdot \cdots \cdot 3\cdot 2\cdot 1\,.}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">factorial</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">factorial</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>120.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>120
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="combinations">
<h2>Combinations<a class="headerlink" href="#combinations" title="Permalink to this headline">¶</a></h2>
<p>Factorials are critical for calculating the probabilities of possible outcomes. Given a set of <span class="math notranslate nohighlight">\(n\)</span> elements a <em>combination</em> is a choice of <span class="math notranslate nohighlight">\(k\)</span> items without regard to the ordering. There are <span class="math notranslate nohighlight">\(_nC_k\)</span> (“<em>n</em>-choose-<em>k</em>”) ways to select such a combination, where</p>
<div class="math notranslate nohighlight">
\[_nC_k = \binom{n}{k} := \frac{n!}{k!(n-k)!}.\]</div>
<p><span class="math notranslate nohighlight">\(_nC_k\)</span> is also referred to as the <em>binomial coefficient</em>.</p>
<p>For example, there are six ways we can choose two items from a set of four items:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">comb</span>

<span class="n">comb</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>6.0
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="infinite-series">
<h2>Infinite series<a class="headerlink" href="#infinite-series" title="Permalink to this headline">¶</a></h2>
<p>Consider the infinite series</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
S &amp;= a+a x+a x^{2}+a x^{3} + \cdots \\
&amp;= \sum_{k=0}^{\infty} a x^{k}.
\end{align*}\]</div>
<p>If <span class="math notranslate nohighlight">\(x&lt;0\)</span>, the series converges, since <span class="math notranslate nohighlight">\(\lim_{k\to\infty} x^k = 0.\)</span> We can solve for <span class="math notranslate nohighlight">\(S\)</span> by noting that</p>
<div class="math notranslate nohighlight">
\[x S=a x+a x^{2}+ x^{3} + \cdots,\]</div>
<p>which implies that</p>
<div class="math notranslate nohighlight">
\[S-x S=a,\]</div>
<p>and therefore</p>
<div class="math notranslate nohighlight">
\[S=\frac{a}{1-x}.\]</div>
</div>
<div class="section" id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h2>
<p>A function is a mapping from an input to an output. For example,</p>
<div class="math notranslate nohighlight" id="equation-func">
<span class="eqno">(1)<a class="headerlink" href="#equation-func" title="Permalink to this equation">¶</a></span>\[\begin{equation}
f(x) = 2x^2 - 3
\end{equation}\]</div>
<p>is a function of the variable <span class="math notranslate nohighlight">\(x\)</span>. Since <span class="math notranslate nohighlight">\(x\)</span> can take any real value and return a real value, we write <span class="math notranslate nohighlight">\(f\!: \R \rightarrow \R\)</span>. (Actually, this particular <span class="math notranslate nohighlight">\(f\)</span> will also work on complex numbers, which we do not consider.)</p>
<p>We might think of the function in <a class="reference internal" href="#equation-func">(1)</a> as a special case of a more general set of functions with parameters <span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(b\)</span>, <span class="math notranslate nohighlight">\(c\)</span>,</p>
<div class="amsmath math notranslate nohighlight" id="equation-a85b1982-6ff6-45ad-9d23-4c868229722d">
<span class="eqno">(2)<a class="headerlink" href="#equation-a85b1982-6ff6-45ad-9d23-4c868229722d" title="Permalink to this equation">¶</a></span>\[\begin{equation}
f(x; a, b, c) = ax^2 + bx + c.
\end{equation}\]</div>
<p>The parameters — also called “coefficients” — are typically considered fixed, whereas <span class="math notranslate nohighlight">\(x\)</span> is a variable. The figure below shows three such functions, with different parameters <span class="math notranslate nohighlight">\((a, b, c)\)</span>.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">c</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="c1"># Set up the spines</span>
<span class="k">for</span> <span class="n">loc</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="s1">&#39;top&#39;</span><span class="p">]:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="n">loc</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">loc</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="s1">&#39;left&#39;</span><span class="p">]:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="n">loc</span><span class="p">]</span><span class="o">.</span><span class="n">set_position</span><span class="p">((</span><span class="s1">&#39;data&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
        
<span class="k">for</span> <span class="n">params</span> <span class="ow">in</span> <span class="p">[(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)]:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">params</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/01a math_34_0.png" src="_images/01a math_34_0.png" />
</div>
</div>
</div>
<div class="section" id="the-fundamental-theorems-of-calculus">
<h2>The fundamental theorems of calculus<a class="headerlink" href="#the-fundamental-theorems-of-calculus" title="Permalink to this headline">¶</a></h2>
<p>Let <span class="math notranslate nohighlight">\(f\)</span> be a continuous function defined on the closed interval <span class="math notranslate nohighlight">\([a,b]\)</span>. Let <span class="math notranslate nohighlight">\(F\)</span> be the function defined as</p>
<div class="math notranslate nohighlight">
\[F(x) = \int_a^x f(z) \, dz.\]</div>
<p>Then <span class="math notranslate nohighlight">\(F\)</span> is differentiable on the open interval <span class="math notranslate nohighlight">\((a,b)\)</span> and</p>
<div class="math notranslate nohighlight">
\[F'(x) = f(x)\]</div>
<p>for all <span class="math notranslate nohighlight">\(x\)</span> in <span class="math notranslate nohighlight">\((a,b)\)</span>. Moreover,</p>
<div class="math notranslate nohighlight">
\[\int_a^b f(x) \, dx = F(b) - F(a).\]</div>
<div class="section" id="linearity-of-integrals">
<h3>Linearity of integrals<a class="headerlink" href="#linearity-of-integrals" title="Permalink to this headline">¶</a></h3>
<p>The integral of a linear combination is the linear combination of the integrals. That is, given two functions <span class="math notranslate nohighlight">\(f(x)\)</span> and <span class="math notranslate nohighlight">\(g(x)\)</span>, and constants <span class="math notranslate nohighlight">\(\alpha\)</span> and <span class="math notranslate nohighlight">\(\beta\)</span>,</p>
<div class="math notranslate nohighlight">
\[\int _{a}^{b}[\alpha f(x)+\beta g(x)]\,dx=\alpha \int _{a}^{b}f(x)\,dx+\beta \int _{a}^{b}g(x)\,dx.\]</div>
</div>
</div>
<div class="section" id="gaussian-integral">
<span id="sec-gauss-integral"></span><h2>Gaussian integral<a class="headerlink" href="#gaussian-integral" title="Permalink to this headline">¶</a></h2>
<p>Consider the function</p>
<div class="math notranslate nohighlight">
\[f(z) = e^{-z^2},\]</div>
<p>plotted below:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="p">(</span><span class="k">lambda</span> <span class="n">z</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">z</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/01a math_39_0.png" src="_images/01a math_39_0.png" />
</div>
</div>
<p>Somewhat incredibly, the area under this curve — called the Gaussian integral, named for <a class="reference external" href="https://en.wikipedia.org/wiki/Carl_Friedrich_Gauss">Carl Friedrich Gauss</a> — is <span class="math notranslate nohighlight">\(\sqrt{\pi}\)</span>,</p>
<div class="math notranslate nohighlight" id="equation-gauss-integral">
<span class="eqno">(3)<a class="headerlink" href="#equation-gauss-integral" title="Permalink to this equation">¶</a></span>\[\int _{-\infty }^{\infty }e^{-z^2}\,dz = \sqrt{\pi}.\]</div>
<p>We can confirm using the <code class="docutils literal notranslate"><span class="pre">sympy</span></code> package for doing symbolic math.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sympy</span>

<span class="c1"># Two &quot;o&quot;s represent infinity</span>
<span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">oo</span>

<span class="n">z</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>

<span class="c1"># Calculate the Gaussian integral</span>
<span class="n">sympy</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">z</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="o">-</span><span class="n">oo</span><span class="p">,</span> <span class="n">oo</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\displaystyle \sqrt{\pi}\]</div>
</div>
</div>
<p>For a more general form of the integral, use the change of variables</p>
<div class="math notranslate nohighlight">
\[z = \frac{x-b}{\sqrt{2c^2}},\]</div>
<p>where <span class="math notranslate nohighlight">\(b\)</span> and <span class="math notranslate nohighlight">\(c\)</span> are constants, implying that</p>
<div class="math notranslate nohighlight">
\[dz = \frac{dx}{\sqrt{2c^2}}.\]</div>
<p>Then</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
{\large\int_{-\infty }^{\infty }} \exp(-z^2)\,dz \; = \; \frac{1}{\sqrt{2c^2}} {\large\int_{-\infty }^{\infty }}\exp\left\{-\frac{1}{2}\left(\frac{x-b}{c}\right)^2\right\}dx,
\end{equation*}\]</div>
<p>so</p>
<div class="math notranslate nohighlight">
\[{\large\int_{-\infty }^{\infty }}\exp\left\{-\frac{1}{2}\left(\frac{x-b}{c}\right)^2\right\}dx = \sqrt{2 \pi c^2}.\]</div>
<p>We will revisit this fact when we discuss the normal probability distribution.</p>
</div>
<div class="section" id="the-gamma-function">
<h2>The gamma function<a class="headerlink" href="#the-gamma-function" title="Permalink to this headline">¶</a></h2>
<p>The gamma function,</p>
<div class="math notranslate nohighlight">
\[\Gamma(x) := \int _{0}^{\infty }s^{x-1}e^{-s}ds, \quad x&gt;0,\]</div>
<p>is a generalization of the factorial. That is, for any positive integer <span class="math notranslate nohighlight">\(n\)</span>,</p>
<div class="math notranslate nohighlight">
\[\Gamma(n+1) = n\Gamma(n) = n!\]</div>
<p>But <span class="math notranslate nohighlight">\(\Gamma(x)\)</span> is defined over any positive real number, not just the integers. It is effectively a continuous function that connects the values of the factorial function, as shown below.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">gamma</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

<span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.25</span><span class="p">,</span><span class="mf">5.5</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">gamma</span><span class="p">(</span><span class="n">z</span><span class="p">),</span> <span class="s1">&#39;g--&#39;</span><span class="p">)</span>

<span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">gamma</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="s1">&#39;ko&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$\Gamma(x)$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/01a math_44_0.png" src="_images/01a math_44_0.png" />
</div>
</div>
<p>Another useful fact about the gamma function is that</p>
<div class="math notranslate nohighlight">
\[\Gamma\left(\frac{1}{2}\right) = \sqrt{\pi},\]</div>
<p>which can be seen by writing the Gaussian integral <a class="reference internal" href="#equation-gauss-integral">(3)</a> as</p>
<div class="math notranslate nohighlight">
\[\sqrt{\pi} = \int _{-\infty }^{\infty }e^{-z^{2}}dz=2\int _{0}^{\infty }e^{-z^{2}}dz.\]</div>
<p>The second equality follows from the fact that <span class="math notranslate nohighlight">\(e^{-z^2}\)</span> is an <em>even</em> function, meaning it is symmetric about zero — that is, <span class="math notranslate nohighlight">\(f(x)=f(-x)\)</span>.</p>
<p>After the change of variable <span class="math notranslate nohighlight">\(z=\sqrt{t}\)</span>,</p>
<div class="math notranslate nohighlight">
\[2\int _{0}^{\infty}e^{-z^2}dz = 2\int_{0}^{\infty}\frac{1}{2}\ e^{-t}\ t^{-\frac{1}{2}}dt = \int_{0}^{\infty}e^{-t}\ t^{-\frac{1}{2}}dt = \Gamma \left({\frac {1}{2}}\right).\]</div>
<div class="admonition-exercise admonition">
<p class="admonition-title">Exercise</p>
<p>Using the <code class="docutils literal notranslate"><span class="pre">gamma</span></code> function defined in <code class="docutils literal notranslate"><span class="pre">scipy.special</span></code>, write a loop that that confirms that</p>
<div class="math notranslate nohighlight">
\[\Gamma(n+1) = n\Gamma(n)\]</div>
<p>for <span class="math notranslate nohighlight">\(n\in\{1,2,\ldots,5\}\)</span>.</p>
</div>
<div class="admonition-solution dropdown admonition">
<p class="admonition-title">Solution</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">gamma</span> <span class="k">as</span> <span class="n">Γ</span>

<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">n</span><span class="o">*</span><span class="n">Γ</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">==</span> <span class="n">Γ</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="taylor-series">
<span id="taylorseries"></span><h2>Taylor series<a class="headerlink" href="#taylor-series" title="Permalink to this headline">¶</a></h2>
<p>The Taylor series approximation of a function, <span class="math notranslate nohighlight">\(f(x)\)</span>, around some point <span class="math notranslate nohighlight">\(a\)</span> is</p>
<div class="math notranslate nohighlight">
\[f(x) = f(a) + f'(a)(x-a) + \frac{f''(a)}{2!}(x-a)^{2} + \frac{f'''(a)}{3!}(x-a)^{3} + \cdots\]</div>
<p>where <span class="math notranslate nohighlight">\(f'\)</span> is the first derivative, <span class="math notranslate nohighlight">\(f''\)</span> is the second derivative, etc.</p>
<p>As we add more terms to the expansion, we will get arbitrarily close to the true function <span class="math notranslate nohighlight">\(f(x)\)</span> as long as we stay near <span class="math notranslate nohighlight">\(a\)</span>. For example, let</p>
<div class="math notranslate nohighlight">
\[f(x) = \ln(1+x),\]</div>
<p>and take the expansion around <span class="math notranslate nohighlight">\(a=0\)</span>,</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\ln(1+x) &amp;= \ln(1+a) + (1+a)^{-1}(x-a) - \frac{(1+a)^{-2}}{2}(x-a)^2 + \frac{2(1+a)^{-3}}{6}(x-a)^3 \cdots \\
&amp;= 0 + x - \frac{1}{2}x^2 + \frac{1}{3}x^3 - \frac{1}{4}x^4 + \cdots \\
&amp;= \sum_{k=1}^{\infty} \frac{(-1)^{k-1} x^k}{k}.
\end{align*}\]</div>
<div class="tip admonition">
<p class="admonition-title">Key fact</p>
<p>If we keep only the first term of the expansion, we get a very useful fact about the logarithm function, namely that, when <span class="math notranslate nohighlight">\(x\)</span> is close to zero,</p>
<div class="math notranslate nohighlight">
\[\ln(1+x) \approx x.\]</div>
</div>
<p>As the table below shows, the approximation is quite close for small numbers, but starts to degrade when <span class="math notranslate nohighlight">\(x&gt;0.1.\)</span></p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
</style>
<table id="T_39a77_">
  <thead>
    <tr>
      <th class="col_heading level0 col0" >x</th>
      <th class="col_heading level0 col1" >log(1+x)</th>
      <th class="col_heading level0 col2" >Error</th>
      <th class="col_heading level0 col3" >% Error</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td id="T_39a77_row0_col0" class="data row0 col0" >0.001000</td>
      <td id="T_39a77_row0_col1" class="data row0 col1" >0.001000</td>
      <td id="T_39a77_row0_col2" class="data row0 col2" >-0.000000</td>
      <td id="T_39a77_row0_col3" class="data row0 col3" >-0.05%</td>
    </tr>
    <tr>
      <td id="T_39a77_row1_col0" class="data row1 col0" >0.003981</td>
      <td id="T_39a77_row1_col1" class="data row1 col1" >0.003973</td>
      <td id="T_39a77_row1_col2" class="data row1 col2" >-0.000008</td>
      <td id="T_39a77_row1_col3" class="data row1 col3" >-0.20%</td>
    </tr>
    <tr>
      <td id="T_39a77_row2_col0" class="data row2 col0" >0.015849</td>
      <td id="T_39a77_row2_col1" class="data row2 col1" >0.015725</td>
      <td id="T_39a77_row2_col2" class="data row2 col2" >-0.000124</td>
      <td id="T_39a77_row2_col3" class="data row2 col3" >-0.79%</td>
    </tr>
    <tr>
      <td id="T_39a77_row3_col0" class="data row3 col0" >0.063096</td>
      <td id="T_39a77_row3_col1" class="data row3 col1" >0.061185</td>
      <td id="T_39a77_row3_col2" class="data row3 col2" >-0.001911</td>
      <td id="T_39a77_row3_col3" class="data row3 col3" >-3.12%</td>
    </tr>
    <tr>
      <td id="T_39a77_row4_col0" class="data row4 col0" >0.251189</td>
      <td id="T_39a77_row4_col1" class="data row4 col1" >0.224094</td>
      <td id="T_39a77_row4_col2" class="data row4 col2" >-0.027095</td>
      <td id="T_39a77_row4_col3" class="data row4 col3" >-12.09%</td>
    </tr>
    <tr>
      <td id="T_39a77_row5_col0" class="data row5 col0" >1.000000</td>
      <td id="T_39a77_row5_col1" class="data row5 col1" >0.693147</td>
      <td id="T_39a77_row5_col2" class="data row5 col2" >-0.306853</td>
      <td id="T_39a77_row5_col3" class="data row5 col3" >-44.27%</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Including higher-order terms improves the approximation, as shown here:</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_taylor_ln1px</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Plot the Taylor series expansion of ln(1+x) near 0&#39;&#39;&#39;</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="c1"># Set up the spines</span>
    <span class="k">for</span> <span class="n">loc</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="s1">&#39;top&#39;</span><span class="p">]:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="n">loc</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">loc</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="s1">&#39;left&#39;</span><span class="p">]:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="n">loc</span><span class="p">]</span><span class="o">.</span><span class="n">set_position</span><span class="p">((</span><span class="s1">&#39;data&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">)</span>
    
    <span class="c1"># Draw f(x) over x &gt; -1</span>
    <span class="n">fx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">x</span><span class="o">&gt;-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">x</span><span class="o">&gt;-</span><span class="mi">1</span><span class="p">],</span> <span class="n">fx</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

    <span class="c1"># Draw the Taylor approximation</span>
    <span class="n">approx</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">approx</span> <span class="o">+=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">k</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="n">k</span>
        
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">approx</span><span class="p">,</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;N=</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_taylor_ln1px</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/01a math_54_0.png" src="_images/01a math_54_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_taylor_ln1px</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/01a math_55_0.png" src="_images/01a math_55_0.png" />
</div>
</div>
<p>Notice that as we increase the number of terms in the polynomial the approximation (black dotted line) stays closer to the true function (red) for a wider range of values.</p>
</div>
<div class="section" id="vectors">
<h2>Vectors<a class="headerlink" href="#vectors" title="Permalink to this headline">¶</a></h2>
<p>A (Euclidean) vector is is a geometric object with direction and length.</p>
<p>For example, the vector (4,2) originates at the origin (0,0) and ends at the point (4,2).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_vectors</span><span class="p">(</span><span class="n">vecs</span><span class="p">,</span> <span class="n">lims</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;A function for plotting vectors&#39;&#39;&#39;</span>
    <span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">cm</span>
    
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

    <span class="c1"># Set the axes through the origin</span>
    <span class="k">for</span> <span class="n">spine</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="s1">&#39;bottom&#39;</span><span class="p">]:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="n">spine</span><span class="p">]</span><span class="o">.</span><span class="n">set_position</span><span class="p">(</span><span class="s1">&#39;zero&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">spine</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="s1">&#39;top&#39;</span><span class="p">]:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="n">spine</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="n">lims</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="n">lims</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>

    <span class="c1"># draw vectors</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">rainbow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">vecs</span><span class="p">)))</span>
    
    <span class="k">for</span> <span class="n">v</span><span class="p">,</span><span class="n">c</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">vecs</span><span class="p">,</span><span class="n">colors</span><span class="p">):</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">*</span><span class="n">v</span><span class="p">,</span>
                 <span class="n">head_width</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">head_length</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span>
                 <span class="n">length_includes_head</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">fc</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="n">c</span><span class="p">,</span>
                 <span class="n">label</span><span class="o">=</span><span class="s1">&#39;(</span><span class="si">{:.2f}</span><span class="s1">, </span><span class="si">{:.2f}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">v</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_vectors</span><span class="p">([</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">],</span> <span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/01a math_61_0.png" src="_images/01a math_61_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_vectors</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">c</span><span class="p">,</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">c</span><span class="p">,</span> <span class="n">c</span><span class="p">],</span> <span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/01a math_62_0.png" src="_images/01a math_62_0.png" />
</div>
</div>
<p>The length of a vector is given by the “Euclidean” or <span class="math notranslate nohighlight">\(\ell^2\)</span> norm</p>
<div class="math notranslate nohighlight">
\[{\displaystyle \left\|{\boldsymbol {x}}\right\|_{2} := \sqrt{\mathbf{x}\cdot\mathbf{x}} = \sqrt{x_{1}^{2}+\cdots +x_{n}^{2}}}.\]</div>
<p>It is easy to see why this is true for vectors on a 2-dimensional plane if we remember the Pythagorean Theorem.</p>
<p>The expression under the square root is the <em>dot product</em>, <span class="math notranslate nohighlight">\(\mathbf{x}\cdot \mathbf{x}\)</span>, where</p>
<div class="math notranslate nohighlight">
\[\mathbf{a}\cdot \mathbf{b} := \sum_{i=1}^n a_i b_i = a_1b_1 + \ldots + a_nb_n.\]</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>The <span class="math notranslate nohighlight">\(\ell^1\)</span> norm is also known as the “Manhattan” norm or the “taxicab” norm because it measures the distance that a car would have to travel between two points on a road laid out on a grid as in New York City.</p>
</div>
<p>Other measures of distance, or <a class="reference external" href="https://en.wikipedia.org/wiki/Norm_(mathematics)">norms</a>, are possible. The <span class="math notranslate nohighlight">\(\ell^1\)</span> norm, for example, is given by</p>
<div class="math notranslate nohighlight">
\[\left\|{\boldsymbol {x}}\right\|_{1}:=\sum _{i=1}^{n}\left|x_{i}\right|.\]</div>
<p>There are several ways to calculate dot products in numpy, as shown below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([4, 2])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>20
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>20
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Preferred method</span>
<span class="n">a</span> <span class="o">@</span> <span class="n">a</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>20
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># calculate length of a</span>
<span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">a</span>  <span class="o">@</span> <span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4.47213595499958
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># equivalently</span>
<span class="kn">from</span> <span class="nn">numpy.linalg</span> <span class="kn">import</span> <span class="n">norm</span>
<span class="n">norm</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4.47213595499958
</pre></div>
</div>
</div>
</div>
<p>The angle (in radians) <span class="math notranslate nohighlight">\(\theta\)</span> between two vectors follows</p>
<div class="math notranslate nohighlight">
\[\cos(\theta) = \frac{a\cdot b}{||a||\cdot||b||},\]</div>
<p>so</p>
<div class="math notranslate nohighlight">
\[\theta = \cos^{-1}\left(\frac{a\cdot b}{||a||\cdot||b||}\right).\]</div>
<p>Two vectors are <em>orthogonal</em> if the angle between them is 90° or <span class="math notranslate nohighlight">\(\frac{\pi}{2}\)</span> radians. Since <span class="math notranslate nohighlight">\(\cos(\pi/2)=0\)</span>, vectors are orthogonal if and only if their dot product is zero.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># angle between a and b</span>
<span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span> <span class="n">a</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">/</span> <span class="n">norm</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">/</span> <span class="n">norm</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.214297435588181
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># convert to degrees</span>
<span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="mf">2.214297435588181</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>126.86989764584402
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># angle between b and c</span>
<span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span> <span class="n">b</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">/</span> <span class="n">norm</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">/</span> <span class="n">norm</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.5707963267948966
</pre></div>
</div>
</div>
</div>
<p>This is indeed equal to <span class="math notranslate nohighlight">\(\pi/2\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">π</span><span class="o">/</span><span class="mi">2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.5707963267948966
</pre></div>
</div>
</div>
</div>
<p>So <span class="math notranslate nohighlight">\(b\)</span> and <span class="math notranslate nohighlight">\(c\)</span> are orthoganal:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">@</span> <span class="n">c</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="matrices">
<h2>Matrices<a class="headerlink" href="#matrices" title="Permalink to this headline">¶</a></h2>
<p>A matrix is a tabular collection of vectors, each with the same number of elements. For example, let <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> be an <span class="math notranslate nohighlight">\(m\times n\)</span> matrix and <span class="math notranslate nohighlight">\(\mathbf{B}\)</span> be an <span class="math notranslate nohighlight">\(n\times p\)</span> matrix,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf {A} ={\begin{pmatrix}a_{11}&amp;a_{12}&amp;\cdots &amp;a_{1n}\\a_{21}&amp;a_{22}&amp;\cdots &amp;a_{2n}\\\vdots &amp;\vdots &amp;\ddots &amp;\vdots \\a_{m1}&amp;a_{m2}&amp;\cdots &amp;a_{mn}\\\end{pmatrix}},\quad \mathbf {B} ={\begin{pmatrix}b_{11}&amp;b_{12}&amp;\cdots &amp;b_{1p}\\b_{21}&amp;b_{22}&amp;\cdots &amp;b_{2p}\\\vdots &amp;\vdots &amp;\ddots &amp;\vdots \\b_{n1}&amp;b_{n2}&amp;\cdots &amp;b_{np}\\\end{pmatrix}}.\end{split}\]</div>
<p>Having defined matrices, it becomes useful to distinguish between two types of vectors: a <span class="math notranslate nohighlight">\(1\times n\)</span> <em>row vector</em></p>
<div class="math notranslate nohighlight">
\[{\displaystyle \mathbf{a} = (a_1, \ldots, a_n)},\]</div>
<p>and an <span class="math notranslate nohighlight">\(n\times 1\)</span> <em>column vector</em></p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{b} = \begin{pmatrix}
b_1\\ 
\vdots\\ 
b_n 
\end{pmatrix}.\end{split}\]</div>
<p>We can think of a matrix either as a group of row vectors stack on top of each other, or a group of column vectors stacked next to each other.</p>
<div class="section" id="matrix-multiplication">
<h3>Matrix multiplication<a class="headerlink" href="#matrix-multiplication" title="Permalink to this headline">¶</a></h3>
<p>The matrix product <span class="math notranslate nohighlight">\(\mathbf{C} = \mathbf{AB}\)</span> is defined to be the <span class="math notranslate nohighlight">\(m \times p\)</span> matrix</p>
<div class="math notranslate nohighlight">
\[\begin{split}{\displaystyle \mathbf {C} ={\begin{pmatrix}c_{11}&amp;c_{12}&amp;\cdots &amp;c_{1p}\\c_{21}&amp;c_{22}&amp;\cdots &amp;c_{2p}\\\vdots &amp;\vdots &amp;\ddots &amp;\vdots \\c_{m1}&amp;c_{m2}&amp;\cdots &amp;c_{mp}\\\end{pmatrix}}}\end{split}\]</div>
<p>such that</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
c_{ij} &amp;= a_{i1}b_{1j}+a_{i2}b_{2j}+\cdots +a_{in}b_{nj} \\
&amp;= \sum_{k=1}^{n}a_{ik}b_{kj},
\end{align*}\]</div>
<p>for <span class="math notranslate nohighlight">\(i=1,\ldots,m\)</span> and <span class="math notranslate nohighlight">\(j=1,\ldots,p.\)</span> Obviously, such multiplication is only possible when the number of columns of <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> equals the number of rows of <span class="math notranslate nohighlight">\(\mathbf{B}.\)</span></p>
<p>This diagram<a class="footnote-reference brackets" href="#wiki-matrix" id="id1">1</a> provides an illustration of the mechanics of matrix multiplication.</p>
<img src="https://upload.wikimedia.org/wikipedia/commons/e/e5/MatrixMultiplication.png" width=500>
<br>
<p>A matrix in numpy is just an array with two dimensions. Here we create two matrices, <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span>, to work with.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">3</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">],</span>
              <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span>  <span class="mi">3</span><span class="p">],</span>
              <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">]])</span>

<span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">],</span>
              <span class="p">[</span> <span class="mi">2</span><span class="p">,</span>  <span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">],</span>
              <span class="p">[</span> <span class="mi">3</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<p>To multiply matrices we take the dot product.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">@</span> <span class="n">B</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[  1,   5,   0],
       [  2,  10, -13],
       [ -6,  -9,   8]])
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="identity-matrix">
<h3>Identity matrix<a class="headerlink" href="#identity-matrix" title="Permalink to this headline">¶</a></h3>
<p>The identity matrix has ones along the main diagonal and zeros elsewhere:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{I} := {\begin{pmatrix}1 &amp; 0 &amp; \cdots &amp; 0\\ 0 &amp; 1 &amp; \cdots &amp; 0\\\vdots &amp;\vdots &amp;\ddots &amp;\vdots \\0 &amp; 0 &amp; \cdots &amp;1\\\end{pmatrix}}.\end{split}\]</div>
<p>Multiplying any matrix or vector by the appropriately-sized identity matrix is like multiplying any number by one — we just get the initial matrix or vector as the answer.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><code class="docutils literal notranslate"><span class="pre">numpy</span></code> follows a convention from other programs of using a pun to refer to the identity matrix — <code class="docutils literal notranslate"><span class="pre">np.eye</span></code>. Get it?</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1., 0., 0.],
       [0., 1., 0.],
       [0., 0., 1.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># multiply by the identity matrix</span>
<span class="n">A</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 3.,  2., -2.],
       [ 1., -4.,  3.],
       [-2.,  1., -2.]])
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="transpose">
<h3>Transpose<a class="headerlink" href="#transpose" title="Permalink to this headline">¶</a></h3>
<p>Two transformations of matrices are frequently used. The first is the <em>transpose</em>, in which all of the elements are reflected across the main diagonal. Equivalently, we can think of writing all of the rows as the columns, and all the columns as rows.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{A}' := {\begin{pmatrix}a_{11}&amp;a_{21}&amp;\cdots &amp;a_{m1}\\a_{12}&amp;a_{22}&amp;\cdots &amp;a_{m2}\\\vdots &amp;\vdots &amp;\ddots &amp;\vdots \\a_{1m}&amp;a_{2m}&amp;\cdots &amp;a_{mn}\\\end{pmatrix}}\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 3,  1, -2],
       [ 2, -4,  1],
       [-2,  3, -2]])
</pre></div>
</div>
</div>
</div>
<p>The transpose of a row vector is a column vector, and vice versa. Therefore, the dot product <span class="math notranslate nohighlight">\(\mathbf{x} \cdot \mathbf{x}\)</span> for a column vector <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> can also be written as <span class="math notranslate nohighlight">\(\mathbf{x}'\mathbf{x}\)</span>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> were a row vector, <span class="math notranslate nohighlight">\(\mathbf{x}'\mathbf{x}\)</span> would be a square matrix, not a scalar.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The transpose is sometimes written as <span class="math notranslate nohighlight">\(\mathbf{x}^\intercal\)</span>, but in economics and finance, people mostly use the “prime” symbol as in <span class="math notranslate nohighlight">\(\mathbf{x}'\)</span> instead. While this could be confused with the derivative symbol, the meaning should usually be quite clear. For example, while it is reasonable to assume that <span class="math notranslate nohighlight">\(f'(x)\)</span> is the derivative of the function <span class="math notranslate nohighlight">\(f\)</span> with respect to <span class="math notranslate nohighlight">\(x\)</span>, it wouldn’t make sense that <span class="math notranslate nohighlight">\(\mathbf{x}'\)</span> would be a derivative since <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> isn’t a function.</p>
</div>
</div>
<div class="section" id="inverse">
<h3>Inverse<a class="headerlink" href="#inverse" title="Permalink to this headline">¶</a></h3>
<p>The second important transformation is the <em>inverse</em> of <span class="math notranslate nohighlight">\(\mathbf{A}\)</span>. This is the matrix <span class="math notranslate nohighlight">\(\mathbf{A}^{-1}\)</span> such that</p>
<div class="math notranslate nohighlight">
\[\mathbf{A} \times \mathbf{A}^{-1} = \mathbf{I}.\]</div>
<p>If a matrix is not square it may have a <em>left inverse</em> and a <em>right inverse</em>. A square matrix has only one inverse, which can be multiplied on either side.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>There is some rounding error in this calculation, but if you look closely you’ll see that this is indeed the identity matrix.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numpy.linalg</span> <span class="kn">import</span> <span class="n">inv</span>

<span class="n">A</span> <span class="o">@</span> <span class="n">inv</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 1.00000000e+00,  0.00000000e+00,  0.00000000e+00],
       [ 0.00000000e+00,  1.00000000e+00, -4.44089210e-16],
       [-1.11022302e-16, -2.22044605e-16,  1.00000000e+00]])
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><code class="docutils literal notranslate"><span class="pre">np.allclose(a,b)</span></code> is a boolean function that returns <code class="docutils literal notranslate"><span class="pre">True</span></code> when the corresponding elements of <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code> are all “close,” meaning the difference between them is negligible, perhaps due to numerical imprecision.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">A</span> <span class="o">@</span> <span class="n">inv</span><span class="p">(</span><span class="n">A</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="solving-systems-of-equations">
<h3>Solving systems of equations<a class="headerlink" href="#solving-systems-of-equations" title="Permalink to this headline">¶</a></h3>
<p>Matrices are especially useful for compactly writing systems of equations. For example, consider the system of <span class="math notranslate nohighlight">\(m\)</span> linear equations</p>
<div class="math notranslate nohighlight">
\[\begin{split}{\begin{matrix}a_{11}x_{1}+\cdots +a_{1n}x_{n}=b_{1}\\a_{21}x_{1}+\cdots +a_{2n}x_{n}=b_{2}\\\vdots \\a_{m1}x_{1}+\cdots +a_{mn}x_{n}=b_{m}\end{matrix}}.\end{split}\]</div>
<p>By defining the column vectors <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{b}\)</span>,
the system can be written in matrix notation as <span class="math notranslate nohighlight">\({\displaystyle \mathbf {Ax} =\mathbf {b}}.\)</span></p>
<p>Premultiplying both sides of this equation by <span class="math notranslate nohighlight">\(\mathbf{A}^{-1}\)</span> allows us to solve for <span class="math notranslate nohighlight">\(\mathbf{x}\)</span>,</p>
<div class="math notranslate nohighlight" id="equation-a-inv-b">
<span class="eqno">(4)<a class="headerlink" href="#equation-a-inv-b" title="Permalink to this equation">¶</a></span>\[\mathbf{x} = \mathbf{A}^{-1} \mathbf{b}.\]</div>
<p>For example, suppose we wish to solve the system of equations</p>
<div class="amsmath math notranslate nohighlight" id="equation-7aa34cc4-6d81-4ed0-bafc-360cafdd09a3">
<span class="eqno">(5)<a class="headerlink" href="#equation-7aa34cc4-6d81-4ed0-bafc-360cafdd09a3" title="Permalink to this equation">¶</a></span>\[\begin{align}
3x_1 + 2x_2 - 2x_3 &amp;= 1,\\
x_1 - 4x_2 + 3x_3 &amp;= 2, \\
-2x_1 + x_2 + -2x_3 &amp;= -6.
\end{align}\]</div>
<p>Writing this in <span class="math notranslate nohighlight">\(\mathbf {Ax} =\mathbf {b}\)</span> form, we have</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{pmatrix}3 &amp; 2 &amp; -2 \\ 1 &amp; -4 &amp; 3 \\ -2 &amp; 1 &amp; -2 \end{pmatrix} \begin{pmatrix}x_1\\x_2\\x_3\end{pmatrix} =\begin{pmatrix}1\\2\\-6\end{pmatrix}.
\end{split}\]</div>
<p>Solving for <span class="math notranslate nohighlight">\(\mathbf{x} := (x_1, x_2, x_3)'\)</span> using <a class="reference internal" href="#equation-a-inv-b">(4)</a>  is straightforward with <code class="docutils literal notranslate"><span class="pre">numpy</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">inv</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">@</span> <span class="n">b</span>
<span class="n">x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1.],
       [2.],
       [3.]])
</pre></div>
</div>
</div>
</div>
<p>So <span class="math notranslate nohighlight">\(x_1=1\)</span>, <span class="math notranslate nohighlight">\(x_2=2\)</span>, and <span class="math notranslate nohighlight">\(x_3=3\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Confirm that Ax = b</span>
<span class="n">A</span> <span class="o">@</span> <span class="n">x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 1.],
       [ 2.],
       [-6.]])
</pre></div>
</div>
</div>
</div>
<p>Multiplying a matrix by a vector applies a linear transformation to the vector. In the case of <span class="math notranslate nohighlight">\(\mathbf{A}^{-1} \mathbf{b}\)</span>, we transform the <span class="math notranslate nohighlight">\(\mathbf{b}\)</span> vector into the <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> vector according to the transformation given by <span class="math notranslate nohighlight">\(\mathbf{A}^{-1}\)</span>. Similarly, applying <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> to <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> will rotate and stretch it so it equals <span class="math notranslate nohighlight">\(\mathbf{b}\)</span>.</p>
</div>
<div class="section" id="quadratic-form">
<h3>Quadratic form<a class="headerlink" href="#quadratic-form" title="Permalink to this headline">¶</a></h3>
<p>In many finance applications we will often encounter the <em>quadratic form</em></p>
<div class="math notranslate nohighlight" id="equation-qform">
<span class="eqno">(6)<a class="headerlink" href="#equation-qform" title="Permalink to this equation">¶</a></span>\[\mathbf{x'Ax},\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> is a <em>symmetric</em> matrix, meaning for all elements, <span class="math notranslate nohighlight">\(a_{ij}=a_{ji}\)</span>.</p>
<p>The derivative of a quadratic form is</p>
<div class="math notranslate nohighlight">
\[\frac{d}{d\mathbf{x}} \mathbf{x'Ax} = 2\mathbf{Ax}.\]</div>
</div>
</div>
<div class="section" id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">¶</a></h2>
<div class="admonition-exercise admonition">
<p class="admonition-title">Exercise</p>
<ol class="simple">
<li><p>Suppose <span class="math notranslate nohighlight">\(\mathbf{x}' = (w_1, w_2)\)</span> and <span class="math notranslate nohighlight">\(\mathbf{A} = \begin{pmatrix} a &amp; b \\ b &amp; c \end{pmatrix}.\)</span> Calculate the quadratic form as in equation <a class="reference internal" href="#equation-qform">(6)</a> by hand. Take the derivative of each equation and confirm that <span class="math notranslate nohighlight">\(\frac{d}{d\mathbf{x}} \mathbf{x'Ax} = 2\mathbf{Ax}.\)</span></p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">sympy</span></code> to confirm that <span class="math notranslate nohighlight">\(e^{\pi i} + 1 = 0.\)</span> Check also that <code class="docutils literal notranslate"><span class="pre">numpy</span></code> gives the same result. Here you’ll want to begin by defining <code class="docutils literal notranslate"><span class="pre">i</span> <span class="pre">=</span> <span class="pre">0</span> <span class="pre">+</span> <span class="pre">1j</span></code> as the imaginary part of a complex number.</p></li>
</ol>
</div>
<div class="admonition-solution dropdown admonition">
<p class="admonition-title">Solution</p>
<p>This solution uses <code class="docutils literal notranslate"><span class="pre">sympy</span></code> to do the calculations, but I encourage you to do the calculations yourself.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">Matrix</span><span class="p">,</span> <span class="n">expand</span><span class="p">,</span> <span class="n">diff</span><span class="p">,</span> <span class="n">factor</span>

<span class="n">w1</span><span class="p">,</span> <span class="n">w2</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;w1 w2&#39;</span><span class="p">)</span>
<span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;a b c&#39;</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([</span><span class="n">w1</span><span class="p">,</span> <span class="n">w2</span><span class="p">])</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">],</span> <span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">]])</span>

<span class="n">xpAx</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">A</span> <span class="o">*</span> <span class="n">x</span>
<span class="n">xpAx</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[\displaystyle \left[\begin{matrix}w_{1} \left(a w_{1} + b w_{2}\right) + w_{2} \left(b w_{1} + c w_{2}\right)\end{matrix}\right]\]</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># The answer is represented as a 1x1 matrix, so we&#39;ll just make it a scalar</span>
<span class="n">xpAx</span> <span class="o">=</span> <span class="n">expand</span><span class="p">(</span><span class="n">xpAx</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">xpAx</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[\displaystyle a w_{1}^{2} + 2 b w_{1} w_{2} + c w_{2}^{2}\]</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">diff</span><span class="p">(</span><span class="n">xpAx</span><span class="p">,</span> <span class="n">w1</span><span class="p">)</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[\displaystyle 2 a w_{1} + 2 b w_{2}\]</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">diff</span><span class="p">(</span><span class="n">xpAx</span><span class="p">,</span> <span class="n">w2</span><span class="p">)</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[\displaystyle 2 b w_{1} + 2 c w_{2}\]</div>
<p>These results are clearly the same as <span class="math notranslate nohighlight">\(2A\mathbf{x}\)</span>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">2</span> <span class="o">*</span> <span class="n">A</span> <span class="o">*</span> <span class="n">x</span>
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \left[\begin{matrix}2 a w_{1} + 2 b w_{2}\\2 b w_{1} + 2 c w_{2}\end{matrix}\right]\end{split}\]</div>
<p>For Question 2, just put the mathematical expression into <code class="docutils literal notranslate"><span class="pre">sympy</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># notice that we are *overloading* the exp function here</span>

<span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">exp</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span> <span class="n">I</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>

<span class="n">exp</span><span class="p">(</span><span class="n">pi</span> <span class="o">*</span> <span class="n">I</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
</pre></div>
</div>
<p>0</p>
<p>And we can use <code class="docutils literal notranslate"><span class="pre">numpy</span></code> to verify that the calculation gives an answer of zero. (If you look at <code class="docutils literal notranslate"><span class="pre">z</span></code> here you’ll see it’s not exactly zero, but is really close. I’m using <code class="docutils literal notranslate"><span class="pre">np.isclose</span></code> to verify that the difference is neglibible.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>True</p>
</div>
<hr class="footnotes docutils" />
<dl class="footnote brackets">
<dt class="label" id="wiki-matrix"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>Image from <a class="reference external" href="https://commons.wikimedia.org/wiki/File:MatrixMultiplication.png">Wikipedia</a>.</p>
</dd>
</dl>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="intro.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Introduction</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="01b%20finance.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Asset returns</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Noah Stoffman<br/>
    
        &copy; Copyright 2022.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>